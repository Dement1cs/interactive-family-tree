{% extends "base.html" %}

{% block title %}
    {{ person["first_name"] }} {{ person["last_name"] or "" }} — Profile
{% endblock %}

{% block content %}
<div class="person-actions" style="margin-bottom: 10px;">
    <a href="{{ url_for('edit_person', person_id=person['id']) }}">Edit</a>

    <form action="{{ url_for('delete_person_route', person_id=person['id']) }}"
          method="post"
          style="display:inline;"
          onsubmit="return confirm('Delete this person?');">
        <button type="submit">Delete</button>
    </form>
</div>

<div class="person-detail">

    <div class="person-header">
        <div class="person-avatar">
            <!-- заглушка -->
            <span class="avatar-initials">
                {{ person["first_name"][0] }}{% if person["last_name"] %}{{ person["last_name"][0] }}{% endif %}
            </span>
        </div>

        <div class="person-main-info">
            <h2>{{ person["first_name"] }} {{ person["last_name"] or "" }}</h2>

            <p class="person-dates">
                {% if person["birth_date"] %}
                    Born: {{ person["birth_date"] }}
                {% endif %}
                {% if person["death_date"] %}
                    &nbsp;•&nbsp; Died: {{ person["death_date"] }}
                {% endif %}
            </p>

            {% if person["gender"] %}
                <p class="person-gender">Gender: {{ person["gender"] }}</p>
            {% endif %}
        </div>
    </div>

    <div class="person-body">
        <section class="person-section">
            <h3>Relations</h3>

            <h4>Parents</h4>
            {% if parents and parents|length > 0 %}
                <ul>
                {% for p in parents %}
                    <li>
                        <a href="{{ url_for('person_detail', person_id=p['id']) }}">
                            {{ p["first_name"] }} {{ p["last_name"] or "" }}
                        </a>
                    </li>
                {% endfor %}
                </ul>
            {% else %}
                <p class="muted">No parents linked yet.</p>
            {% endif %}

            <h4>Children</h4>
            {% if children and children|length > 0 %}
                <ul>
                {% for c in children %}
                    <li>
                        <a href="{{ url_for('person_detail', person_id=c['id']) }}">
                            {{ c["first_name"] }} {{ c["last_name"] or "" }}
                        </a>
                    </li>
                {% endfor %}
                </ul>
            {% else %}
                <p class="muted">No children linked yet.</p>
            {% endif %}

            <h4>Spouse</h4>
            {% if spouses and spouses|length > 0 %}
                <ul>
                {% for s in spouses %}
                    <li>
                        <a href="{{ url_for('person_detail', person_id=s['id']) }}">
                            {{ s["first_name"] }} {{ s["last_name"] or "" }}
                        </a>
                    </li>
                {% endfor %}
                </ul>
            {% else %}
                <p class="muted">No spouse linked yet.</p>
            {% endif %}
        </section>

        <!-- Description -->
        <section class="person-section">
            <h3>Description</h3>
            {% if person["notes"] %}
                <p>{{ person["notes"] }}</p>
            {% else %}
                <p class="muted">No description yet.</p>
            {% endif %}
        </section>

        <!-- Gallery -->
        <section class="person-section">
            <h3>Photo Gallery</h3>
            <p class="muted">
                Photo gallery placeholder. In the future this section can show uploaded photos.
            </p>
        </section>
    </div>

    <p>
        <a href="{{ url_for('persons') }}">← Back to list</a>
    </p>
</div>
{% endblock %}